/*! For license information please see main.bb0a6339.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),l=n(43),a=n(950);function o(e){var t="https://213415b5-7b36-46f6-ae5b-80d9ba920744.preview.emergentagent.com";const d=function(){const[e,t]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1),[o,u]=(0,r.useState)(""),[d,p]=(0,r.useState)(null),[h,m]=(0,r.useState)("explorer"),[g,v]=(0,r.useState)(null),[y,b]=(0,r.useState)([]),[k,w]=(0,r.useState)(!1),[S,x]=(0,r.useState)("");(0,r.useEffect)((()=>{const e=localStorage.getItem("password_authenticated"),n=localStorage.getItem("access_token");"true"===e&&t(!0),n&&(p(n),l(!0))}),[]),(0,r.useEffect)((()=>{const e=new URLSearchParams(window.location.search),t=e.get("access_token"),r=e.get("error");if(r)return console.error("Authentication error:",r),void x("OneDrive authentication failed. Please try again.");t&&!n&&(localStorage.setItem("access_token",t),p(t),l(!0),window.history.replaceState({},document.title,window.location.pathname))}),[n]);const E=async e=>{e.preventDefault(),w(!0),x("");try{const e=await fetch("".concat(f,"/api/auth/password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:o})});if(e.ok){await e.json();t(!0),localStorage.setItem("password_authenticated","true"),u("")}else x("Invalid password. Please try again.")}catch(S){console.error("Password authentication failed:",S),x("Authentication failed. Please try again.")}finally{w(!1)}},N=async()=>{try{const e=await fetch("".concat(f,"/api/auth/login")),t=await e.json();t.auth_url&&(window.location.href=t.auth_url)}catch(S){console.error("OneDrive login failed:",S),x("OneDrive login failed. Please try again.")}},C=()=>{m("explorer"),v(null),b([])},_=()=>{localStorage.removeItem("password_authenticated"),localStorage.removeItem("access_token"),t(!1),l(!1),p(null),v(null),m("explorer"),u(""),x("")};return e?n?"video"===h&&g?(0,a.jsx)(i,{video:g,backendUrl:f,accessToken:d,onBack:C}):"photo"===h&&g?(0,a.jsx)(c,{photo:g,accessToken:d,onBack:C,allPhotos:y}):(0,a.jsxs)("div",{className:"app",children:[(0,a.jsx)("header",{className:"app-header",children:(0,a.jsxs)("div",{className:"header-content",children:[(0,a.jsx)("h1",{children:"\ud83d\uddc2\ufe0f OneDrive Explorer"}),(0,a.jsxs)("div",{className:"header-info",children:[(0,a.jsx)("span",{className:"user-info",children:"\ud83d\udcc1 File Browser & Media Viewer"}),(0,a.jsx)("button",{onClick:_,className:"logout-button",children:"\ud83d\udeaa Logout"})]})]})}),(0,a.jsx)("main",{className:"main-content",children:(0,a.jsx)(s,{accessToken:d,onPlayVideo:e=>{v(e),m("video")},onViewPhoto:async e=>{v(e),b([e]),m("photo")}})})]}):(0,a.jsx)("div",{className:"login-container",children:(0,a.jsxs)("div",{className:"login-card",children:[(0,a.jsx)("h1",{children:"\ud83d\uddc2\ufe0f OneDrive Explorer"}),(0,a.jsx)("p",{children:"Connect to your OneDrive to explore files"}),S&&(0,a.jsxs)("div",{className:"error-message",children:["\u26a0\ufe0f ",S]}),(0,a.jsx)("button",{onClick:N,className:"login-button",children:"Sign in with Microsoft OneDrive"}),(0,a.jsx)("button",{onClick:_,className:"logout-link",children:"\u2190 Back to Password Login"})]})}):(0,a.jsx)("div",{className:"login-container",children:(0,a.jsxs)("div",{className:"login-card",children:[(0,a.jsx)("h1",{children:"\ud83d\uddc2\ufe0f OneDrive Explorer"}),(0,a.jsx)("p",{children:"Secure access to your OneDrive files"}),S&&(0,a.jsxs)("div",{className:"error-message",children:["\u26a0\ufe0f ",S]}),(0,a.jsxs)("form",{onSubmit:E,className:"password-form",children:[(0,a.jsx)("input",{type:"password",placeholder:"Enter access password",value:o,onChange:e=>u(e.target.value),className:"password-input",required:!0}),(0,a.jsx)("button",{type:"submit",className:"login-button",disabled:k,children:k?"Authenticating...":"Access Explorer"})]})]})})};l.createRoot(document.getElementById("root")).render((0,a.jsx)(r.StrictMode,{children:(0,a.jsx)(d,{})}))})();
//# sourceMappingURL=main.bb0a6339.js.map